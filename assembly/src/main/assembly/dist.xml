<assembly>

    <id>main</id>

    <formats>
        <!-- <format>tar.gz</format> -->
        <format>zip</format>
    </formats>

    <baseDirectory>daisy-pipeline</baseDirectory>

    <fileSets>

        <fileSet>
            <directory>target/dependency/felix-framework-${felix.framework.version}/bundle</directory>
            <includes>
              <include>*.jar</include>
            </includes>
            <outputDirectory>/system/felix</outputDirectory>
        </fileSet>

        <fileSet>
            <directory>src/main/resources</directory>
            <includes>
                <include>etc/**</include>
                <include>samples/**</include>
                <include>NOTICE.txt</include>
                <include>README.txt</include>
            </includes>
            <outputDirectory>/</outputDirectory>
        </fileSet>

        <fileSet>
            <directory>src/main/filtered-resources</directory>
            <includes>
                <include>**</include>
            </includes>
            <outputDirectory>/</outputDirectory>
            <filtered>true</filtered>
        </fileSet>

        <!-- Copy the launcher with the correct file mode -->
        <fileSet>
            <directory>src/main/resources</directory>
            <includes>
                <include>bin/dp2</include>
            </includes>
            <outputDirectory>/</outputDirectory>
            <fileMode>0755</fileMode>
        </fileSet>
        <fileSet>
            <directory>target/downloads</directory>
            <includes>
              <include>*.jar</include>
            </includes>
            <outputDirectory>/system/framework</outputDirectory>
        </fileSet>
    </fileSets>
    <files>
      <file>
        <source>target/dependency/felix-framework-${felix.framework.version}/bin/felix.jar</source>
        <outputDirectory>system/launcher</outputDirectory>
      </file>
    </files>
    <dependencySets>
       <dependencySet>
         <outputDirectory>/system/felix</outputDirectory>
         <includes>
           <include>org.osgi:*</include>
           <include>org.slf4j:*</include>
           <include>org.apache.felix:*</include>
           <include>ch.qos.logback:*</include>
         </includes>
         <useProjectArtifact>false</useProjectArtifact>
         <useTransitiveDependencies>false</useTransitiveDependencies>
       </dependencySet>
       <dependencySet>
         <outputDirectory>/system/framework</outputDirectory>
         <!-- <includes>
           <include>org.daisy.pipeline:*</include>
           <include>org.daisy.example.libs:*</include>
           <include>com.googlecode.guava-osgi:guava-osgi</include>
           <include>com.xmlcalabash:com.xmlcalabash</include>
           <include>nu.validator.htmlparser:htmlparser</include>
           <include>commons-codec:commons-codec</include>
           <include>commons-fileupload:commons-fileupload</include>
           <include>commons-io:commons-io</include>
           <include>org.restlet.osgi:org.restlet</include>
           <include>org.restlet.osgi:org.restlet.ext.fileupload</include>
           <include>org.restlet.osgi:org.restlet.ext.xml</include>
           <include>org.codehaus.woodstox:woodstox-core-lgpl</include>
           <include>org.codehaus.woodstox:stax2-api</include>
         </includes> -->
         <excludes>
           <exclude>org.daisy.pipeline:webservice</exclude>
           <exclude>org.daisy.pipeline.modules:*</exclude>
           <exclude>org.slf4j:*</exclude>
           <exclude>org.apache.felix:*</exclude>
           <exclude>org.osgi:*</exclude>
           <exclude>ch.qos.logback:*</exclude>
         </excludes>
         <useProjectArtifact>false</useProjectArtifact>
         <useTransitiveDependencies>false</useTransitiveDependencies>
       </dependencySet>
       <dependencySet>
         <outputDirectory>/system/frontend</outputDirectory>
         <includes>
           <include>org.daisy.pipeline:webservice</include>
         </includes>
         <useProjectArtifact>false</useProjectArtifact>
         <useTransitiveDependencies>false</useTransitiveDependencies>
       </dependencySet>
       <dependencySet>
         <outputDirectory>/modules</outputDirectory>
         <includes>
           <include>org.daisy.pipeline.modules:*</include>
         </includes>
         <useProjectArtifact>false</useProjectArtifact>
         <useTransitiveDependencies>false</useTransitiveDependencies>
       </dependencySet>
     </dependencySets>
</assembly>



